import{bf as M,bF as T,aI as c,r as H,j as e,ba as P,bb as l,bd as E,cl as $,dm as F,dn as R,bB as a,bq as A,bs as V,bp as D}from"./vendor.0db79331.js";import{a as f}from"./vendor_axios.5abceb0c.js";import{b as L,L as q}from"./index.83743980.js";import"./vendor_core_js_pure.0c656a9d.js";import"./vendor_react_epic_spinners.9d092b60.js";import"./vendor_mui_datatables.7a9f4bd2.js";import"./vendor_lodash.50cc0a37.js";import"./vendor_react_slick.6e983608.js";import"./vendor_react_easy_edit.0ee73127.js";import"./vendor_react_player.4dedbcdd.js";var t="C:\\Users\\poona\\OneDrive\\Documents\\Poonam\\React\\Work\\kalam\\src\\components\\pages\\SlotBooking.jsx";const v="https://dev-join.navgurukul.org/api/",te=()=>{const{enqueueSnackbar:m}=M(),{studentId:N}=T(),j=[{id:1,from:"9:00",to:"10:00"},{id:2,from:"10:00",to:"11:00"},{id:3,from:"11:00",to:"12:00"},{id:7,from:"12:00",to:"13:00"},{id:4,from:"13:00",to:"14:00"},{id:5,from:"14:00",to:"15:00"},{id:6,from:"15:00",to:"16:00"}],[k,_]=c.useState(!0),[r,p]=c.useState({from:"",to:"",id:null,is_cancelled:!0}),[d,W]=c.useState(new Date),[u,B]=c.useState({}),[h,S]=c.useState(j),w=15,b=o=>{const i=a(o),n=i.format("YYYY-MM-DD");W(n),f.get(`${v}/slot/interview/check/ondate/${n}/1`).then(({data:s})=>{if(s.data.length){const g=a().isSame(i,"day")?s.data.filter(x=>x.availiblity&&a().isBefore(a(x.from,"HH:MM"),"hour")):s.data.filter(x=>x.availiblity);S(g)}else S(j)})},y=async()=>{var i,n;return(n=(i=(await f.get(`${v}slot/interview/${N}`)).data)==null?void 0:i.data[0])!=null?n:null},C=async()=>{var i,n;const o=await f.get(`${v}/students/${N}`);return(n=(i=o==null?void 0:o.data)==null?void 0:i.data[0])!=null?n:null};H.exports.useEffect(()=>{(async()=>{const o=await y();o&&p(o);const i=await C();if(i){const{name:n,stage:s,lastTransition:g}=i||{name:null,stage:null,lastTransition:{id:null}};B({name:n,stage:L[s],transitionID:g.id}),b(d),_(!1)}})()},[]);const Y=()=>{f.delete(`${v}slot/interview/stundet/${r.id}`).then(({data:o})=>{o.message==="Successfully inserted slot deleted"?(m("Slot Cancelled",{variant:"info"}),b(d),p({is_cancelled:!0})):m("Slot Not Cancelled",{variant:"error"})})},I=()=>{const{from:o,to:i}=r;f.post(`${v}slot/interview/student`,{student_id:N,student_name:u.name,topic_name:u.stage,transition_id:u.transitionID,start_time:o,end_time_expected:i,duration:"1hr",on_date:d}).then(({data:n})=>{n.status==="successfully_scheduled"?y().then(s=>{s&&p(s),m("Slot Booked",{variant:"success"})}).catch(()=>m("Cannot Book Slot",{variant:"error"})):m("Cannot Book Slot",{variant:"error"})}).catch(()=>{m("Couldn't Book Slot!",{variant:"error"})})};return k?e.exports.jsxDEV(q,{},void 0,!1,{fileName:t,lineNumber:185,columnNumber:5},void 0):["English Interview Pending (2nd Round)","Culture Fit Interview Pending (4th Round)","Pending Culture Fit Re-Interview"].includes(u.stage)?e.exports.jsxDEV(P,{maxWidth:"md",sx:{bgcolor:"background.paper  ",p:4},children:r.is_cancelled?e.exports.jsxDEV(e.exports.Fragment,{children:[e.exports.jsxDEV(l,{variant:"h5",fontWeight:"medium",children:"Book Interview Slot"},void 0,!1,{fileName:t,lineNumber:200,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h6",sx:{mt:2},children:["Book Interview Slot ",u.name]},void 0,!0,{fileName:t,lineNumber:203,columnNumber:11},void 0),e.exports.jsxDEV(E,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:"1.2rem"},children:[e.exports.jsxDEV($,{dateAdapter:F,children:e.exports.jsxDEV(R,{displayStaticWrapperAs:"desktop",margin:"normal",id:"date-picker-dialog",format:"yyyy-MM-dd",value:d,onChange:o=>{b(o)},shouldDisableDate:o=>a(o).isAfter(a().set("date",a().get("date")+w)),disablePast:!0,inputVariant:"outlined",fullWidth:!0,KeyboardButtonProps:{"aria-label":"change date"},renderInput:o=>e.exports.jsxDEV(A,{...o},void 0,!1,{fileName:t,lineNumber:239,columnNumber:42},void 0)},void 0,!1,{fileName:t,lineNumber:215,columnNumber:15},void 0)},void 0,!1,{fileName:t,lineNumber:214,columnNumber:13},void 0),h.length>0?e.exports.jsxDEV(V,{container:!0,justifyContent:"center",spacing:2,children:h.map(({id:o,from:i,to:n})=>e.exports.jsxDEV(V,{item:!0,sm:6,md:4,children:e.exports.jsxDEV(D,{color:"primary",fullWidth:!0,variant:r.id===o?"contained":"outlined",sx:{padding:"8px",fontSize:"14px",fontWeight:r.id!==o&&"600",border:r.id!==o&&"2px solid"},onClick:()=>p({id:o,from:i,to:n,is_cancelled:!0}),children:[a(i,"HH").format("h:mm a")," -"," ",a(n,"HH").format("h:mm a")]},void 0,!0,{fileName:t,lineNumber:246,columnNumber:21},void 0)},o,!1,{fileName:t,lineNumber:245,columnNumber:19},void 0))},void 0,!1,{fileName:t,lineNumber:243,columnNumber:15},void 0):e.exports.jsxDEV(l,{variant:"h6",textAlign:"center",children:["No Slots Available on ",a(d).format("MMM D, YYYY")]},void 0,!0,{fileName:t,lineNumber:267,columnNumber:15},void 0)]},void 0,!0,{fileName:t,lineNumber:206,columnNumber:11},void 0),e.exports.jsxDEV(D,{variant:"contained",color:"primary",disabled:h.length===0||!r.id,onClick:()=>I(),children:"Book Slot"},void 0,!1,{fileName:t,lineNumber:273,columnNumber:11},void 0)]},void 0,!0):e.exports.jsxDEV(e.exports.Fragment,{children:[e.exports.jsxDEV(l,{variant:"h4",fontWeight:"medium",children:"Interview Slot Booked"},void 0,!1,{fileName:t,lineNumber:284,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h5",fontWeight:"medium",sx:{mt:2},children:"Slot Details"},void 0,!1,{fileName:t,lineNumber:287,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h6",sx:{mt:1},fontWeight:"normal",children:[e.exports.jsxDEV("span",{style:{fontWeight:"500"},children:"Student Name:"},void 0,!1,{fileName:t,lineNumber:291,columnNumber:13},void 0)," ",r.student_name]},void 0,!0,{fileName:t,lineNumber:290,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h6",fontWeight:"normal",children:[e.exports.jsxDEV("span",{style:{fontWeight:"500"},children:"Topic:"},void 0,!1,{fileName:t,lineNumber:295,columnNumber:13},void 0)," ",r.topic_name]},void 0,!0,{fileName:t,lineNumber:294,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h6",fontWeight:"normal",children:[e.exports.jsxDEV("span",{style:{fontWeight:"500"},children:"On:"},void 0,!1,{fileName:t,lineNumber:298,columnNumber:13},void 0)," ",a(r.on_date).format("D MMM YYYY")||""]},void 0,!0,{fileName:t,lineNumber:297,columnNumber:11},void 0),e.exports.jsxDEV(l,{variant:"h6",fontWeight:"normal",children:[e.exports.jsxDEV("span",{style:{fontWeight:"500"},children:"From"},void 0,!1,{fileName:t,lineNumber:302,columnNumber:13},void 0)," ",a(r.start_time,"HH").format("h:mm a")," ",e.exports.jsxDEV("span",{style:{fontWeight:"500"},children:"To"},void 0,!1,{fileName:t,lineNumber:304,columnNumber:13},void 0)," ",a(r.end_time_expected,"HH").format("h:mm a")]},void 0,!0,{fileName:t,lineNumber:301,columnNumber:11},void 0),e.exports.jsxDEV(D,{variant:"contained",color:"primary",sx:{mt:3},onClick:()=>Y(),children:"Delete Slot"},void 0,!1,{fileName:t,lineNumber:307,columnNumber:11},void 0)]},void 0,!0)},void 0,!1,{fileName:t,lineNumber:191,columnNumber:5},void 0):e.exports.jsxDEV(E,{style:{display:"flex",justifyContent:"center"},children:e.exports.jsxDEV(l,{color:"primary",variant:"h2",style:{marginTop:"0.4rem"},children:"You cannot book slot"},void 0,!1,{fileName:t,lineNumber:320,columnNumber:7},void 0)},void 0,!1,{fileName:t,lineNumber:319,columnNumber:5},void 0)};export{te as default};
